@prefix rdf:  <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix xsd:  <http://www.w3.org/2001/XMLSchema#> .
@prefix owl:  <http://www.w3.org/2002/07/owl#> .
@prefix dct:  <http://purl.org/dc/terms/> .
@prefix csvw: <http://www.w3.org/ns/csvw#> .

@base <https://w3id.org/csvw-dp> .
@prefix dp: <https://w3id.org/csvw-dp#> .


# =====================================================
# Ontology declaration
# =====================================================

dp:
    a owl:Ontology ;
    dct:title "CSVW Differential Privacy Extension Vocabulary" ;
    owl:versionInfo "0.3.0" ;
    owl:versionIRI <https://w3id.org/csvw-dp/0.3.0> ;
    dct:description """
    A vocabulary extending W3C CSV on the Web metadata with explicit
    differential privacy modeling primitives, including contribution bounds,
    grouping constraints, and public partition specifications for both
    categorical and continuous columns.
    """ ;
    dct:creator <https://github.com/dscc-admin-ch> ;
    dct:publisher <https://github.com/dscc-admin-ch> ;
    dct:created "2026-02-04"^^xsd:date ;
    dct:license <https://creativecommons.org/licenses/by/4.0/> ;
    owl:imports <http://www.w3.org/ns/csvw> ;
    rdfs:seeAlso <https://github.com/dscc-admin-ch/csvw-dp> .


# =====================================================
# CORE CLASSES
# =====================================================

dp:DPBounded a rdfs:Class ;
    rdfs:label "DP-bounded entity" ;
    rdfs:comment """
    Abstract class for any entity to which differential privacy
    contribution or size bounds may be attached.
    """ .


dp:GroupingKey a rdfs:Class ;
    rdfs:subClassOf dp:DPBounded ;
    rdfs:label "Grouping key" ;
    rdfs:comment """
    An entity that defines a group-by key space for DP aggregation.
    Includes single columns and composite (multi-column) keys.
    """ .


dp:ColumnGroup a rdfs:Class ;
    rdfs:subClassOf dp:GroupingKey ;
    rdfs:label "Column group" ;
    rdfs:comment """
    A grouping key formed by two or more columns.
    """ .


dp:PartitionKey a rdfs:Class ;
    rdfs:subClassOf dp:DPBounded ;
    rdfs:label "Partition key" ;
    rdfs:comment """
    Represents one publicly declared partition within a grouping key.

    Can describe:
    • A categorical value
    • A numeric interval
    • A composite key value

    May carry per-partition DP bounds that refine or override
    bounds declared on the enclosing grouping key.
    """ .


# =====================================================
# CSVW INTEGRATION
# =====================================================

csvw:Table
    rdfs:subClassOf dp:DPBounded ;
    rdfs:comment """
    A CSVW table treated as a single DP partition.
    """ .


csvw:Column
    rdfs:subClassOf dp:GroupingKey ;
    rdfs:comment """
    A CSVW column that may serve as a grouping key for DP aggregation.
    """ .


# =====================================================
# COLUMN-LEVEL PROPERTIES
# =====================================================

dp:privacyId a rdf:Property ;
    rdfs:domain csvw:Column ;
    rdfs:range xsd:boolean ;
    rdfs:label "privacyId" ;
    rdfs:comment "True if the column identifies the privacy unit." .


dp:nullableProportion a rdf:Property ;
    rdfs:domain csvw:Column ;
    rdfs:range xsd:decimal ;
    rdfs:label "nullableProportion" ;
    rdfs:comment "Approximate fraction of null values." .


# =====================================================
# PUBLIC PARTITIONS (DP-relevant)
# =====================================================

dp:publicPartitions a rdf:Property ;
    rdfs:domain dp:GroupingKey ;
    rdfs:range rdf:List ;
    rdfs:label "publicPartitions" ;
    rdfs:comment """
    Declared universe of publicly known partitions for a grouping key.

    Declaring public partitions avoids data-dependent release
    and may affect privacy accounting.
    """ .


# =====================================================
# PARTITION KEY STRUCTURE (structural)
# =====================================================

dp:partitionValue a rdf:Property ;
    rdfs:domain dp:PartitionKey ;
    rdfs:range rdfs:Literal ;
    rdfs:label "partitionValue" ;
    rdfs:comment "Categorical partition value." .


dp:lowerBound a rdf:Property ;
    rdfs:domain dp:PartitionKey ;
    rdfs:range xsd:decimal ;
    rdfs:label "lowerBound" ;
    rdfs:comment "Lower bound of numeric partition (inclusive by default)." .


dp:upperBound a rdf:Property ;
    rdfs:domain dp:PartitionKey ;
    rdfs:range xsd:decimal ;
    rdfs:label "upperBound" ;
    rdfs:comment "Upper bound of numeric partition (exclusive by default)." .


dp:partitionLabel a rdf:Property ;
    rdfs:domain dp:PartitionKey ;
    rdfs:range xsd:string ;
    rdfs:label "partitionLabel" ;
    rdfs:comment "Human-readable label for the partition." .


dp:components a rdf:Property ;
    rdfs:domain dp:PartitionKey ;
    rdfs:range rdf:Resource ;
    rdfs:label "components" ;
    rdfs:comment """
    Defines a composite partition as a mapping from grouping-key columns
    to per-column PartitionKeys.
    """ .


# =====================================================
# DP AGGREGATION BOUNDS
# =====================================================

dp:maxPartitionLength a rdf:Property ;
    rdfs:domain dp:DPBounded ;
    rdfs:range xsd:positiveInteger ;
    rdfs:label "maxPartitionLength" ;
    rdfs:comment "Maximum number of rows within the scope of this entity." .


dp:partitionLength a rdf:Property ;
    rdfs:domain dp:DPBounded ;
    rdfs:range xsd:positiveInteger ;
    rdfs:label "partitionLength" ;
    rdfs:comment "Observed number of rows within the scope of this entity, if known." .


dp:maxInfluencedPartitions a rdf:Property ;
    rdfs:domain dp:DPBounded ;
    rdfs:range xsd:positiveInteger ;
    rdfs:label "maxInfluencedPartitions" ;
    rdfs:comment "Maximum number of partitions a single individual may influence (l₀ bound)." .


dp:maxPartitionContribution a rdf:Property ;
    rdfs:domain dp:DPBounded ;
    rdfs:range xsd:positiveInteger ;
    rdfs:label "maxPartitionContribution" ;
    rdfs:comment "Maximum contributions per individual within one partition (l∞ bound)." .


dp:maxNumPartitions a rdf:Property ;
    rdfs:domain dp:GroupingKey ;
    rdfs:range xsd:positiveInteger ;
    rdfs:label "maxNumPartitions" ;
    rdfs:comment "Maximum number of distinct partitions defined by the grouping key." .


# =====================================================
# COLUMN GROUP STRUCTURE
# =====================================================

dp:columns a rdf:Property ;
    rdfs:domain dp:ColumnGroup ;
    rdfs:range rdf:List ;
    rdfs:label "columns" ;
    rdfs:comment "Columns forming the composite grouping key." .
